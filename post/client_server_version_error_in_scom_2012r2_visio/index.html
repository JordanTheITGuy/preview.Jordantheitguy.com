<!doctype html><html dir=ltr lang=en data-theme=dark><head>
<title>
Jordan Benzing
|
Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings
</title>
<meta charset=utf-8><meta name=generator content="Hugo 0.92.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name=description content="
      Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?


    ">
<link rel=stylesheet href=/css/main.min.db014ffeb1f9f8d8ca6cf10049b6503179b7cd8b435a5757d85b9c6e880bc638.css integrity="sha256-2wFP/rH5+NjKbPEASbZQMXm3zYtDWldX2FucbogLxjg=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=/css/markupHighlight.min.058b31f17db60602cc415fd63b0427e7932fbf35c70d8e341a4c39385f5f6f3e.css integrity="sha256-BYsx8X22BgLMQV/WOwQn55MvvzXHDY40Gkw5OF9fbz4=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous>
<link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon>
<link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png>
<link rel=canonical href=http://preview.jordantheitguy.com/post/client_server_version_error_in_scom_2012r2_visio/>
<script type=text/javascript src=/js/anatole-header.min.2a2cd9614b7d007dfbb75e8da19e3a0fa872ceab53c6d000c00b7a0c89b85bfc.js integrity="sha256-KizZYUt9AH37t16NoZ46D6hyzqtTxtAAwAt6DIm4W/w=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.7fd87181cdd7e8413aa64b6867bb32f3a8dc242e684fc7d5bbb9f600dbc2b6eb.js integrity="sha256-f9hxgc3X6EE6pktoZ7sy86jcJC5oT8fVu7n2ANvCtus=" crossorigin=anonymous></script>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings">
<meta name=twitter:description content="Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?">
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"post","name":"Visio 2010\/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings","headline":"Visio 2010\/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings","alternativeHeadline":"","description":"
      Wouldn\u0027t it be cool if we could make better Visio Drawings using SCOM Data?


    ","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/preview.jordantheitguy.com\/post\/client_server_version_error_in_scom_2012r2_visio\/"},"author":{"@type":"Person","name":"Jordan Benzing"},"creator":{"@type":"Person","name":"Jordan Benzing"},"accountablePerson":{"@type":"Person","name":"Jordan Benzing"},"copyrightHolder":{"@type":"Person","name":"Jordan Benzing"},"copyrightYear":"2015","dateCreated":"2015-10-21T00:00:00.00Z","datePublished":"2015-10-21T00:00:00.00Z","dateModified":"2015-10-21T00:00:00.00Z","publisher":{"@type":"Organization","name":"Jordan Benzing","url":"http://preview.jordantheitguy.com/","logo":{"@type":"ImageObject","url":"http:\/\/preview.jordantheitguy.com\/favicons\/favicon-32x32.png","width":"32","height":"32"}},"image":[],"url":"http:\/\/preview.jordantheitguy.com\/post\/client_server_version_error_in_scom_2012r2_visio\/","wordCount":"645","genre":[],"keywords":[]}</script>
</head>
<body>
<header><div class="page-top
.">
<a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
</a>
<nav>
<ul class=nav__list id=navMenu>
<div class=nav__links>
<li>
<a href=/ title>Home</a>
</li>
<li>
<a href=/post/ title>Tech-Archive</a>
</li>
<li>
<a href=/stories/ title>Non-Tech</a>
</li>
<li>
<a href=/consulting/ title>Consulting</a>
</li>
<li>
<a href=/about/ title>About</a>
</li>
</div>
<ul>
<li>
<a class=theme-switch title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i>
</a>
</li>
</ul>
</ul>
</nav>
</div>
</header>
<div class=wrapper>
<aside><div class="sidebar
.">
<div class=sidebar__content>
<div class=logo-title>
<div class=title>
<img src=/images/JordanTheITGuy.png alt="profile picture">
<h3 title><a href=/>I'm JordanTheITGuy</a></h3>
<div class=description>
<p>I currently work as an Engineer at Patch My PC. <br>I also do some consulting work in the world of IT on the side. <br>I'm a Microsoft MVP for EMS.<br></p>
</div>
</div>
</div>
<ul class=social-links>
<li>
<a href=https://twitter.com/JordanTheITguy rel=me aria-label=Twitter title=Twitter>
<i class="fab fa-twitter fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=https://github.com/JordanTheITGuy rel=me aria-label=Github title=Github>
<i class="fab fa-github fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=https://www.youtube.com/c/JordanTheItGuy rel=me aria-label=Youtube title=Youtube>
<i class="fab fa-youtube fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=https://www.linkedin.com/in/jordan-benzing-432b0619/ rel=me aria-label=Linkedin title=Linkedin>
<i class="fab fa-linkedin fa-2x" aria-hidden=true></i>
</a>
</li>
</ul>
</div><footer class="footer footer--sidebar">
<div class=by_farbox>
<ul class=footer__list>
<li class=footer__item>
&copy;
Jordan Benzing
2022
</li>
</ul>
</div>
</footer>
<script type=text/javascript src=/js/medium-zoom.min.71100d84fab0ad794b8399a66ac810700cc78d703f715dc10af4d7ba7b761362.js integrity="sha256-cRANhPqwrXlLg5mmasgQcAzHjXA/cV3BCvTXunt2E2I=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FGZGWGHKYG"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-FGZGWGHKYG')</script>
</div>
</aside>
<main>
<div class=autopagerize_page_element>
<div class=content>
<div class="post
.">
<div class=post-content>
<div class=post-title>
<h1>Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings</h1>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date>
Wed, Oct 21, 2015
</span>
<em class="fas fa-stopwatch"></em>
<span class=reading-time>4-minute read</span>
</div>
</div><p><strong>The Question:</strong></p>
<h2 id=testing-level-2>Testing Level 2</h2>
<h3 id=testing-level-3>Testing Level 3</h3>
<p>“Wouldn’t it be awesome if we could create pretty Visio Drawings of our systems for the customers to look at and see up-time of servers using SCOM Data?”</p>
<p>Well turns out in fact you can do this! It’s a feature it’s been around in SCOM for quite some time. However it’s not exactly the best documented component and certainly has a couple of pit fulls, among them the frustrating “Client Not Supported Error”.</p>
<p>“What do you mean the client isn’t supported! I just installed the same version everything looks good SCOM WHYYYYY”</p>
<p>It looks like this</p>
<p>Untitled2</p>
<p>Why you ask? I’ll tell you why because it turns out SCOM get’s really angry at Null values in management packs.</p>
<p>The Assumptions:</p>
<p>First of all let me begin this with an assumption. This answer ASSUMES the following things to be true.</p>
<p>You have correctly installed Visio Proffesional or Premium 2010/2013 on your workstation.
You have correctly installed the SCOM Console and it’s pre-requisites on the workstation you are using.
You have appropriate access to SCOM – (REQUIRES SCOM ADMINISTRATOR RIGHTS)
You have correctly installed the SCOM For Visio Add in AFTER doing all these things and the receive the above error message.
The Problem:</p>
<p>The root cause of this problem is as previously stated a Null Value within a management pack that has been installed in your SCOM environment. Some common known examples include the Microsoft Azure Managemetn pack and the NetApp Management Pack for clusters monitoring. Essentially within the SQL tables for the management packs there is a description for the management pack component resource. Specifically icon resources “DiagramIcon” or “u16xu16Icon” and then every now and again a company simply doesn’t put anything in for that field and you get a “NULL” value.</p>
<p><strong>The Resolution:</strong></p>
<p>Let me preface this with “Your milage may vary, use this at your own risk, I am not a Microsoft Employee you can’t say I didn’t warn you, and you can’t sue me if this blows up your environment”. That being said I did get this SQL Query from a Microsoft Employee so that has to count for something. The first component of the solution is determining which management pack contains the Null Value. In order to do this we will need to do something a little scary and that is query the Operations Manager Database. This handy SQL query did the job perfectly for me:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsql data-lang=tsql><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 0</span><span style=color:#ff79c6>SELECT</span> <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>ImageId<span style=color:#ff79c6>]</span>, <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>ReferenceId<span style=color:#ff79c6>]</span>, <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>ManagementPackId<span style=color:#ff79c6>]</span>, <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.TimeAdded, <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.LastModified, <span style=color:#50fa7b>SUBSTRING</span>(<span style=color:#ff79c6>[</span>EnumType<span style=color:#ff79c6>]</span>.EnumTypeName, <span style=color:#bd93f9>39</span>, <span style=color:#bd93f9>100</span>) <span style=color:#ff79c6>AS</span> ImageCategory, <span style=color:#ff79c6>[</span>MPElementView<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>MPElementName<span style=color:#ff79c6>]</span>,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#ff79c6>[</span>ManagementPack<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>ContentReadable<span style=color:#ff79c6>]</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#ff79c6>FROM</span> dbo.ImageReference
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#ff79c6>JOIN</span> dbo.<span style=color:#ff79c6>[</span>Resource<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>on</span> (<span style=color:#ff79c6>[</span>Resource<span style=color:#ff79c6>]</span>.ResourceId <span style=color:#ff79c6>=</span> ImageReference.ImageId)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#50fa7b>LEFT</span> <span style=color:#ff79c6>JOIN</span> dbo.<span style=color:#ff79c6>[</span>Category<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>ON</span> <span style=color:#ff79c6>[</span>Category<span style=color:#ff79c6>]</span>.CategoryTarget <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>[</span>Resource<span style=color:#ff79c6>]</span>.ResourceId
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#50fa7b>LEFT</span> <span style=color:#ff79c6>JOIN</span> dbo.<span style=color:#ff79c6>[</span>EnumType<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>ON</span> <span style=color:#ff79c6>[</span>EnumType<span style=color:#ff79c6>]</span>.EnumTypeId <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>[</span>Category<span style=color:#ff79c6>]</span>.CategoryValue
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#ff79c6>JOIN</span> dbo.MPElementView <span style=color:#ff79c6>ON</span> (ImageReference.ReferenceId <span style=color:#ff79c6>=</span> MPElementView.MPElementId)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#ff79c6>INNER</span> <span style=color:#ff79c6>JOIN</span> dbo.<span style=color:#ff79c6>[</span>ManagementPack<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>ON</span> dbo.ManagementPack.ManagementPackId <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.ManagementPackId <span style=color:#ff79c6>AND</span> dbo.ManagementPack.ContentReadable <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#ff79c6>WHERE</span> dbo.<span style=color:#ff79c6>[</span>ImageReference<span style=color:#ff79c6>]</span>.<span style=color:#ff79c6>[</span>ReferenceId<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>IN</span> (<span style=color:#ff79c6>select</span> dbo.ManagedType.ManagedTypeId <span style=color:#ff79c6>from</span> dbo.ManagedType)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#ff79c6>and</span> dbo.<span style=color:#ff79c6>[</span>Resource<span style=color:#ff79c6>]</span>.ResourceType <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
</code></pre></div><p>If this receives some feedback I will do a write up on how to actually run this query against the database complete with pictures and step by step components.</p>
<p>This should return some information that can be either copy pasted or exported to a CSV/Excel file and reviewed. Once you’ve done this you search for the word “NULL” if this is the root cause you should find something that looks like this:</p>
<p>NULL Data in MP&rsquo;s</p>
<p>To the right side you will then notice the descriptive name of the component in the management pack that uses the item with the null value. That is the item that is causing the problem. From this information you can then determine what vendor you either need to work with to resolve this, OR simply delete the offending management pack and it’s components.</p>
<p>I imagine there might also be a method to use SQL to delete that SPECIFIC piece of the management pack but I haven’t attempted to tackle that at this time.</p>
<p>I hope this helps!</p>
</div>
<div class=post-footer>
<div class=info>
</div>
</div>
<div id=fb_comments_container>
<h2>comments</h2>
<script src=https://utteranc.es/client.js repo=JordanTheITGuy/jordantheitguy.com-comments issue-term=title theme=preferred-color-scheme crossorigin=anonymous async></script>
</div>
</div>
</div>
</div>
</main>
</div><footer class="footer footer--base">
<div class=by_farbox>
<ul class=footer__list>
<li class=footer__item>
&copy;
Jordan Benzing
2022
</li>
</ul>
</div>
</footer>
<script type=text/javascript src=/js/medium-zoom.min.71100d84fab0ad794b8399a66ac810700cc78d703f715dc10af4d7ba7b761362.js integrity="sha256-cRANhPqwrXlLg5mmasgQcAzHjXA/cV3BCvTXunt2E2I=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FGZGWGHKYG"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-FGZGWGHKYG')</script>
</body>
</html>