<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings - JordanTheITGuy</title><meta name=description content="Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?"><meta property="og:title" content="Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings">
<meta property="og:description" content="Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?">
<meta property="og:type" content="article">
<meta property="og:url" content="http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/"><meta property="og:image" content="http://preview.jordantheitguy.com/images/logo.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2015-10-21T00:00:00+00:00">
<meta property="article:modified_time" content="2015-10-21T00:00:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="http://preview.jordantheitguy.com/images/logo.png">
<meta name=twitter:title content="Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings">
<meta name=twitter:description content="Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?">
<meta name=application-name content="JordanTheITGuy">
<meta name=apple-mobile-web-app-title content="JordanTheITGuy"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/><link rel=prev href=http://preview.jordantheitguy.com/posts/how_to_reset_permissions_on_a_users_home_directory/><link rel=next href=http://preview.jordantheitguy.com/posts/powershell_change_localadminpassword/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/preview.jordantheitguy.com\/posts\/client_server_version_error_in_scom_2012r2_visio\/"},"genre":"posts","wordcount":581,"url":"http:\/\/preview.jordantheitguy.com\/posts\/client_server_version_error_in_scom_2012r2_visio\/","datePublished":"2015-10-21T00:00:00+00:00","dateModified":"2015-10-21T00:00:00+00:00","publisher":{"@type":"Organization","name":"Jordan Benzing"},"author":{"@type":"Person","name":"Jordan Benzing"},"description":"Wouldn't it be cool if we could make better Visio Drawings using SCOM Data?"}</script></head>
<body header-desktop header-mobile><script type=text/javascript>(''==='true'&&window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=JordanTheITGuy><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/internalLogo.png data-srcset="/images/internalLogo.png, /images/internalLogo.png 1.5x, /images/internalLogo.png 2x" data-sizes=auto alt=/images/internalLogo.png title=/images/internalLogo.png><span id=id-1 class=typeit></span></a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/categories/> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=JordanTheITGuy><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/internalLogo.png data-srcset="/images/internalLogo.png, /images/internalLogo.png 1.5x, /images/internalLogo.png 2x" data-sizes=auto alt=/images/internalLogo.png title=/images/internalLogo.png><span id=id-2 class=typeit></span></a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author>Jordan Benzing</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2015-10-21>2015-10-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;581 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#testing-level-2>Testing Level 2</a>
<ul>
<li><a href=#testing-level-3>Testing Level 3</a></li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><p><strong>The Question:</strong></p>
<h2 id=testing-level-2>Testing Level 2</h2>
<h3 id=testing-level-3>Testing Level 3</h3>
<p>“Wouldn’t it be awesome if we could create pretty Visio Drawings of our systems for the customers to look at and see up-time of servers using SCOM Data?”</p>
<p>Well turns out in fact you can do this! It’s a feature it’s been around in SCOM for quite some time. However it’s not exactly the best documented component and certainly has a couple of pit fulls, among them the frustrating “Client Not Supported Error”.</p>
<p>“What do you mean the client isn’t supported! I just installed the same version everything looks good SCOM WHYYYYY”</p>
<p>It looks like this</p>
<p>Untitled2</p>
<p>Why you ask? I’ll tell you why because it turns out SCOM get’s really angry at Null values in management packs.</p>
<p>The Assumptions:</p>
<p>First of all let me begin this with an assumption. This answer ASSUMES the following things to be true.</p>
<p>You have correctly installed Visio Proffesional or Premium 2010/2013 on your workstation.
You have correctly installed the SCOM Console and it’s pre-requisites on the workstation you are using.
You have appropriate access to SCOM – (REQUIRES SCOM ADMINISTRATOR RIGHTS)
You have correctly installed the SCOM For Visio Add in AFTER doing all these things and the receive the above error message.
The Problem:</p>
<p>The root cause of this problem is as previously stated a Null Value within a management pack that has been installed in your SCOM environment. Some common known examples include the Microsoft Azure Managemetn pack and the NetApp Management Pack for clusters monitoring. Essentially within the SQL tables for the management packs there is a description for the management pack component resource. Specifically icon resources “DiagramIcon” or “u16xu16Icon” and then every now and again a company simply doesn’t put anything in for that field and you get a “NULL” value.</p>
<p><strong>The Resolution:</strong></p>
<p>Let me preface this with “Your milage may vary, use this at your own risk, I am not a Microsoft Employee you can’t say I didn’t warn you, and you can’t sue me if this blows up your environment”. That being said I did get this SQL Query from a Microsoft Employee so that has to count for something. The first component of the solution is determining which management pack contains the Null Value. In order to do this we will need to do something a little scary and that is query the Operations Manager Database. This handy SQL query did the job perfectly for me:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-tsql data-lang=tsql><span class=ln> 0</span><span class=k>SELECT</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>ImageId</span><span class=o>]</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>ReferenceId</span><span class=o>]</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>ManagementPackId</span><span class=o>]</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=n>TimeAdded</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=n>LastModified</span><span class=p>,</span><span class=w> </span><span class=nf>SUBSTRING</span><span class=p>(</span><span class=o>[</span><span class=n>EnumType</span><span class=o>]</span><span class=p>.</span><span class=n>EnumTypeName</span><span class=p>,</span><span class=w> </span><span class=mi>39</span><span class=p>,</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ImageCategory</span><span class=p>,</span><span class=w> </span><span class=o>[</span><span class=n>MPElementView</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>MPElementName</span><span class=o>]</span><span class=p>,</span><span class=w>
</span><span class=ln> 1</span><span class=w></span><span class=o>[</span><span class=n>ManagementPack</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>ContentReadable</span><span class=o>]</span><span class=w>
</span><span class=ln> 2</span><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>ImageReference</span><span class=w>
</span><span class=ln> 3</span><span class=w></span><span class=k>JOIN</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>Resource</span><span class=o>]</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=p>(</span><span class=o>[</span><span class=n>Resource</span><span class=o>]</span><span class=p>.</span><span class=n>ResourceId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ImageReference</span><span class=p>.</span><span class=n>ImageId</span><span class=p>)</span><span class=w>
</span><span class=ln> 4</span><span class=w></span><span class=nf>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>Category</span><span class=o>]</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=o>[</span><span class=n>Category</span><span class=o>]</span><span class=p>.</span><span class=n>CategoryTarget</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>[</span><span class=n>Resource</span><span class=o>]</span><span class=p>.</span><span class=n>ResourceId</span><span class=w>
</span><span class=ln> 5</span><span class=w></span><span class=nf>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>EnumType</span><span class=o>]</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=o>[</span><span class=n>EnumType</span><span class=o>]</span><span class=p>.</span><span class=n>EnumTypeId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>[</span><span class=n>Category</span><span class=o>]</span><span class=p>.</span><span class=n>CategoryValue</span><span class=w>
</span><span class=ln> 6</span><span class=w></span><span class=k>JOIN</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>MPElementView</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=p>(</span><span class=n>ImageReference</span><span class=p>.</span><span class=n>ReferenceId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MPElementView</span><span class=p>.</span><span class=n>MPElementId</span><span class=p>)</span><span class=w>
</span><span class=ln> 7</span><span class=w></span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>ManagementPack</span><span class=o>]</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>ManagementPack</span><span class=p>.</span><span class=n>ManagementPackId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=n>ManagementPackId</span><span class=w> </span><span class=ow>AND</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>ManagementPack</span><span class=p>.</span><span class=n>ContentReadable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span><span class=ln> 8</span><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>ImageReference</span><span class=o>]</span><span class=p>.</span><span class=o>[</span><span class=n>ReferenceId</span><span class=o>]</span><span class=w> </span><span class=ow>IN</span><span class=w> </span><span class=p>(</span><span class=k>select</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>ManagedType</span><span class=p>.</span><span class=n>ManagedTypeId</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=n>ManagedType</span><span class=p>)</span><span class=w>
</span><span class=ln> 9</span><span class=w></span><span class=ow>and</span><span class=w> </span><span class=n>dbo</span><span class=p>.</span><span class=o>[</span><span class=n>Resource</span><span class=o>]</span><span class=p>.</span><span class=n>ResourceType</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=w>
</span><span class=ln>10</span><span class=w>
</span></code></pre></div><p>If this receives some feedback I will do a write up on how to actually run this query against the database complete with pictures and step by step components.</p>
<p>This should return some information that can be either copy pasted or exported to a CSV/Excel file and reviewed. Once you’ve done this you search for the word “NULL” if this is the root cause you should find something that looks like this:</p>
<p>NULL Data in MP&rsquo;s</p>
<p>To the right side you will then notice the descriptive name of the component in the management pack that uses the item with the null value. That is the item that is causing the problem. From this information you can then determine what vendor you either need to work with to resolve this, OR simply delete the offending management pack and it’s components.</p>
<p>I imagine there might also be a method to use SQL to delete that SPECIFIC piece of the management pack but I haven’t attempted to tackle that at this time.</p>
<p>I hope this helps!</p>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2015-10-21</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/ data-title="Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings" data-via=@JordanTheITGuy><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/><i class="fab fa-linkedin fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/ data-title="Visio 2010/2013 Client Server Version Error in SCOM 2012R2 Visio Drawings" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=http://preview.jordantheitguy.com/posts/client_server_version_error_in_scom_2012r2_visio/><i class="fab fa-reddit fa-fw"></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/how_to_reset_permissions_on_a_users_home_directory/ class=prev rel=prev title="How To Reset Permissions on a Users Home Directory"><i class="fas fa-angle-left fa-fw"></i>How To Reset Permissions on a Users Home Directory</a>
<a href=/posts/powershell_change_localadminpassword/ class=next rel=next title="Powershell Change The Local Administrator Account/Password">Powershell Change The Local Administrator Account/Password<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id=comments><div id=utterances></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.
</noscript></div></article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by ☕ and 🍜</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer">Jordan Benzing</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"title",label:"",lightTheme:"github-light",repo:"JordanTheITGuy/jordantheitguy.com-comments"}},data:{"id-1":"JordanTheITGuy","id-2":"JordanTheITGuy"},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},typeit:{cursorChar:'\u003cspan style="color: #BD93F9" \u003e|\u003c/span\u003e',cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:75}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>